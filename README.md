# ふるさと納税 上限目安計算ツール

https://kafka2306.github.io/furutsatotax/

このリポジトリは、給与収入や副業収入、各種所得控除の入力から、ふるさと納税の「上限目安額」を簡易に見積もるスクリプトを提供します。主に `scripts/calc_furusato.py` を用います。入力は YAML で与えます。

注意: 本ツールは簡易推計です。厳密な税額・上限を保証するものではありません。詳細は「制約・注意点」を参照してください。

## ユーザーにとっての価値（使う理由）
- すぐ分かる: ブラウザで開く/コマンド1本で上限目安を即算出。
- 比較しやすい: iDeCo・DCマッチング・小規模企業共済・配偶者有無など条件を切替えて、上限がどう変わるかを直感的に把握。
- 根拠が見える: 税率や控除の扱い、簡易化の前提をREADMEとドキュメントで明示（法令リンク付き）。
- 再現・共有が楽: 入力はYAMLで保存・再利用でき、来年も同条件で再計算可能。
- 安心して試せる: オフラインで動作、無料、個人情報の入力不要。

## こんな人におすすめ
- 初めてふるさと納税をするので、自分の上限目安を素早く掴みたい。
- 副業や投資の有無、配偶者控除の有無で上限がどれくらい変わるか試したい。
- iDeCoや小規模企業共済、DCマッチング拠出を含めた“トータルの効き方”をざっくり把握したい。
- 数式や前提を確認しながら、手元で安全に試算したい。

## クイックスタート（最短）
1) Web版で試す（おすすめ）
   - 上のリンクを開き、年分と入力値を入れるだけで目安を表示します。
   - 代表的なパターン（給与のみ/副業あり等）も選択できます。
2) ローカルで試す（CLI）
   - Python 3 があればOK。READMEの「計算例」のYAMLを `example.yml` として保存し、
     `python scripts/calc_furusato.py example.yml` を実行します。

よくある質問（抜粋）
- どのくらい正確？: 簡易推計です。住民税の均等割や一部の控除・税額控除は未考慮のため、実額と差が出る場合があります（詳細は下記「制約・注意点」）。
- 年度は対応している？: Web版は年分セレクタ、CLIはYAMLの `tax_year` で切替できます。
- 入力は難しくない？: 必須は主な収入と控除だけ。YAMLはサンプルをコピペして数字を置き換えれば動きます。

## 計算根拠（法的根拠と簡易化の前提）
- 所得税（超過累進税率）: 国税庁タックスアンサー「No.2260 所得税の税率」に基づき、分離課税等を除く総合課税の速算表（5%/10%/20%/23%/33%/40%/45%）を用いて概算します。復興特別所得税は未考慮です。
  - 参考: https://www.nta.go.jp/taxes/shiraberu/taxanswer/shotoku/2260.htm
- 基礎控除（所得税・令和7年度改正）: 令和7・8年分は「95万（〜132万）/88万（〜336万）/68万（〜489万）/63万（〜655万）/58万（〜2,350万）」、2,350万超は従前どおり「48万/32万/16万/0」。令和9年分以後は「95万（〜132万）/58万（〜2,350万）」とし、2,350万超は従前どおり。
  - 参考: 国税庁「令和７年度税制改正による所得税の基礎控除の見直し等について」 https://www.nta.go.jp/users/gensen/2025kiso/index.htm
  - 参考: 国税庁（タックスアンサー等） https://www.nta.go.jp/
- 住民税（所得割の標準税率）: 地方税法における個人住民税の標準税率として、所得割は合計10%（都道府県民税4%＋市町村民税6%）が基本です。本ツールはこの10%のみを採用し、均等割・調整控除・配当控除等は未考慮です。
  - 参考（制度解説・法令）：総務省（個人住民税の制度解説・地方税法） https://www.soumu.go.jp/
- ふるさと納税（寄附金税額控除・特例分の上限）: 個人住民税の寄附金税額控除（特例分）は「住民税所得割額の20%」が上限です。実務上は、所得税側の寄附金控除および住民税側の寄附金税額控除（基本分＋特例分）の組合せにより実質負担2,000円となる範囲が決まります。本ツールは簡易式として「(所得税額＋住民税（所得割）)×20%」を上限目安として近似します。
  - 参考（制度解説）：総務省 ふるさと納税ポータル（寄附金税額控除の概要） https://www.soumu.go.jp/main_sosiki/jichi_zeisei/czaisei/czaisei_seido/furusato/mechanism/deduction.html （上限は「住民税所得割額の2割」）
 - 基礎控除（個人住民税）: 合計所得金額に応じて 43万円（〜2,400万円）/29万円（〜2,450万円）/15万円（〜2,500万円）/0円（超2,500万円）。
  - 参考: 総務省「個人住民税の基礎控除額の見直し等について」等の周知資料（例: https://www.soumu.go.jp/main_content/000667390.pdf）

## 制約・注意点
- 簡易モデルです: 復興特別所得税、住民税の均等割・調整控除、住宅ローン控除、医療費控除、配当控除、配偶者（特別）控除、扶養控除等の多くの控除・税額控除は未考慮です。
- 分離課税等は未対応: 株式・投資等の分離課税（申告分離・源泉分離）や損益通算の扱いは現実とは異なる可能性があります。

## 計算ロジック（概要）
- 合計所得金額（本ツールの定義）: `給与所得控除後の給与 + 副業収入×(1-経費率) + 投資差益`
- 課税所得（所得税）: `合計所得金額 − (社会保険料等の所得控除) − 所得税の基礎控除`
- 課税所得（住民税）: `合計所得金額 − (社会保険料等の所得控除) − 住民税の基礎控除`
- 所得税額（簡易）: 速算表（5%〜45%）で概算（復興特別所得税なし）
- 住民税（簡易）: `課税所得(住民税) × 10%`（所得割のみ）
- 上限目安: `(所得税額 + 住民税(所得割)) × 20%` を100円単位で切り捨て

詳細は `scripts/calc_furusato.py` を参照してください。

## 計算例

入力例（正規化済みの YAML、`example.yml`）
```yaml
salary_income: 7000000       # 給与収入
side_income: 300000          # 副業収入
expense_rate: 0.3            # 経費率 30%
capital_gains: 100000        # 投資差益（簡易）
social_insurance: 900000     # 社会保険料
dc_matching: 240000          # DCマッチング拠出
ideco: 276000                # iDeCo
small_business: 0            # 小規模企業共済
# 基礎控除は省略可（自動計算）。上書きしたい場合は以下のいずれかを指定。
# basic_deduction_income: 480000      # 所得税の基礎控除（自動計算を上書き）
# basic_deduction_resident: 430000    # 住民税の基礎控除（自動計算を上書き）
# basic_deduction: 480000             # 両税目を同一額で一括指定（互換用）
tax_year: 2025                # 令和7年分で計算（CLI --tax-year の代替）
```

実行
```bash
python scripts/calc_furusato.py example.yml
```

出力例（概算・2025年分）
```text
Total income (aggregate): 5410000
Basic deduction (income tax): 630000
Basic deduction (resident tax): 430000
Taxable income (income tax): 3364000
Taxable income (resident tax): 3564000
Estimated income tax: 245300円
Estimated resident tax (income portion): 356400円
Approximate donation limit: 120300円
```

上記の意味
- Total income: 給与所得控除後の給与 + 副業（経費差引後）+ 投資差益 の合計
- Taxable income: 上記合計 −（社会保険料、iDeCo、基礎控除 等）
- Approximate donation limit: 本ツールの簡易式で推定した上限目安（100円単位切捨て）


## MkDocs ドキュメント（制度解説）
- 位置: `docs/` ディレクトリ（トップ: `docs/index.md`）
- 概要ページ: `docs/DC制度解説.md`
- 個別ページ: `docs/DCマッチング拠出.md`, `docs/個人型確定拠出年金_iDeCo.md`, `docs/小規模企業共済.md`
- その他税制（概要）:
  - 所得・住民税: `docs/所得税の基本.md`, `docs/住民税の基本.md`
  - 所得控除: `docs/基礎控除.md`, `docs/社会保険料控除.md`, `docs/医療費控除.md`, `docs/配偶者控除_扶養控除.md`, `docs/生命保険料控除等.md`
  - 税額控除: `docs/住宅ローン控除.md`, `docs/寄附金控除_ふるさと納税.md`
- 設定: `mkdocs.yml`

ローカルでプレビューする場合（MkDocs がインストール済みであること）
```bash
mkdocs serve
# ブラウザで http://127.0.0.1:8000 を開く
```
静的サイトを出力する場合
```bash
mkdocs build
# site/ 以下に出力
```
